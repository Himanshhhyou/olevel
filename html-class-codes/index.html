<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Code Viewer</title>

  <!-- Highlight.js Light Theme -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      color: #111827;
      background-color: #f9fafb;
    }

    .sidebar {
      transition: transform 0.3s ease;
      background-color: #ffffff;
    }

    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }

    .code-container {
      display: flex;
      width: 100%;
      background: #f3f4f6;
      border-radius: 0.5rem;
      overflow-x: auto;
      border: 1px solid #d1d5db;
    }

    pre {
      margin: 0;
      white-space: pre;
      flex-shrink: 0;
    }

    .line-numbers {
      user-select: none;
      padding-right: 1rem;
      color: #6b7280;
      background: #e5e7eb;
      text-align: right;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    .file-item:hover {
      background-color: #3b82f6;
      color: white;
    }

    input::placeholder {
      color: #9ca3af;
    }
  </style>
</head>

<body class="font-sans">

  <!-- Header -->
  <header class="bg-white text-gray-800 p-4 flex justify-between items-center shadow-md">
    <div class="flex items-center gap-2 text-lg font-bold">
      <i class="fas fa-code"></i> LearnAngle
    </div>
    <div class="flex items-center gap-3">
      <button id="menu-btn" class="text-2xl md:hidden p-2 rounded hover:bg-gray-200" onclick="toggleSidebar()">
        <i id="hamburger-icon" class="fas fa-bars"></i>
      </button>
      <button class="p-2 rounded-full bg-gray-200 hover:bg-gray-300" onclick="toggleSettings()" title="Settings">
        <i class="fas fa-cog"></i>
      </button>
    </div>
  </header>

  <!-- Overlay -->
  <div id="overlay" class="fixed inset-0 bg-black bg-opacity-25 hidden z-40" onclick="closeSidebar()"></div>

  <main class="flex flex-1">
    <!-- Sidebar -->
    <aside id="sidebar"
      class="sidebar w-72 border-r border-gray-300 p-4 flex flex-col gap-4 fixed md:static top-0 left-0 h-full z-50 -translate-x-full md:translate-x-0">
      <!-- Tabs -->
      <div class="flex justify-between items-center p-1 rounded-lg">
        <button id="files-tab" class="flex-1 py-2 rounded-md bg-blue-500 text-white font-medium">Files</button>
        <button id="projects-tab" class="flex-1 py-2 rounded-md text-gray-700">Projects</button>
      </div>

      <!-- Search -->
      <input id="search-bar" type="text"
        class="p-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-800 mt-2 focus:ring-2 focus:ring-blue-500"
        placeholder="Search files..." oninput="filterFiles(this.value)" />

      <!-- 🔹 Files List -->
      <div id="files-section" class="file-list flex flex-col gap-2 max-h-[60vh] overflow-y-auto text-sm mt-2">
        <!-- Sample Files -->
        <div class="file-item p-2 flex items-center gap-2 rounded-lg cursor-pointer"
          onclick="loadCode('class-codes/01_my-first-webpage.html')"><i class="fas fa-file-code"></i>
          01_my-first-webpage.html</div>
        <div class="file-item p-2 flex items-center gap-2 rounded-lg cursor-pointer"
          onclick="loadCode('class-codes/02_container-and-empty-tag.html')"><i class="fas fa-file-code"></i>
          02_container-and-empty-tag.html</div>
        <div class="file-item p-2 flex items-center gap-2 rounded-lg cursor-pointer"
          onclick="loadCode('class-codes/03_headings.html')"><i class="fas fa-file-code"></i> 03_headings.html</div>
        <!-- Add remaining files as needed -->
      </div>

      <!-- 🔹 Projects List -->
      <div id="projects-section" class="hidden flex flex-col gap-2 max-h-[60vh] overflow-y-auto text-sm mt-2">
        <div class="file-item p-2 flex items-center gap-2 rounded-lg cursor-pointer"
          onclick="loadCode('mini-projects/maggieRecipe.html')"><i class="fas fa-utensils"></i> maggieRecipe.html
        </div>
        <div class="file-item p-2 flex items-center gap-2 rounded-lg cursor-pointer"
          onclick="loadCode('mini-projects/teacher-day.html')"><i class="fas fa-chalkboard-teacher"></i>
          teacher-day.html
        </div>
        <!-- Add remaining projects -->
      </div>

    </aside>

    <!-- Content -->
    <section class="content flex-1 p-6 overflow-y-auto fade-in">
      <div class="flex justify-between items-center mb-4 flex-wrap gap-2">
        <div class="flex gap-2">
          <button id="copy-btn"
            class="p-2 bg-green-500 text-white rounded-lg hover:bg-green-600 flex items-center gap-1"
            onclick="copyCode()">
            <i class="fas fa-copy"></i> Copy
          </button>
          <button id="download-btn"
            class="p-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 flex items-center gap-1"
            onclick="downloadCode()">
            <i class="fas fa-download"></i> Download
          </button>
        </div>
      </div>

      <div class="code-container rounded-lg">
        <pre class="line-numbers p-4"></pre>
        <pre><code id="code-block" class="language-none"></code></pre>
      </div>

      <iframe id="live-preview" class="w-full h-[400px] mt-6 rounded-lg shadow-lg bg-white"></iframe>
    </section>
  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
  <script>
    let currentFilename = '';

    async function loadCode(filename) {
      try {
        const res = await fetch(filename);
        if (!res.ok) throw new Error("File not found");
        const text = await res.text();
        currentFilename = filename;

        const codeBlock = document.getElementById("code-block");
        const ext = filename.split('.').pop();
        codeBlock.className = `language-${ext === "css" ? "css" : ext === "js" ? "javascript" : "html"}`;
        codeBlock.textContent = text;
        hljs.highlightElement(codeBlock);
        updateLineNumbers(text);

        const preview = document.getElementById("live-preview");
        preview.style.display = ext === "html" ? "block" : "none";
        if (ext === "html") preview.srcdoc = text;

      } catch (err) {
        document.getElementById("code-block").textContent = "⚠️ " + err.message;
        document.querySelector(".line-numbers").textContent = "";
        document.getElementById("live-preview").style.display = "none";
      }
    }

    function updateLineNumbers(text) {
      document.querySelector(".line-numbers").textContent = Array.from({ length: text.split('\n').length }, (_, i) => i + 1).join('\n');
    }

    function copyCode() {
      navigator.clipboard.writeText(document.getElementById("code-block").textContent);
    }

    function downloadCode() {
      if (!currentFilename) return;
      const blob = new Blob([document.getElementById("code-block").textContent], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = currentFilename;
      a.click();
      URL.revokeObjectURL(url);
    }

    function toggleSidebar() {
      const sidebar = document.getElementById("sidebar");
      const overlay = document.getElementById("overlay");
      const icon = document.getElementById("hamburger-icon");
      sidebar.classList.toggle("-translate-x-full");
      overlay.classList.toggle("hidden");
      icon.classList.toggle("fa-bars");
      icon.classList.toggle("fa-times");
    }

    function closeSidebar() {
      document.getElementById("sidebar").classList.add("-translate-x-full");
      document.getElementById("overlay").classList.add("hidden");
      document.getElementById("hamburger-icon").classList.add("fa-bars");
      document.getElementById("hamburger-icon").classList.remove("fa-times");
    }

    // Sidebar Tabs
    document.getElementById("files-tab").addEventListener("click", () => {
      document.getElementById("files-section").classList.remove("hidden");
      document.getElementById("projects-section").classList.add("hidden");
      document.getElementById("search-bar").style.display = "block";
      document.getElementById("files-tab").classList.add("bg-blue-500", "text-white");
      document.getElementById("projects-tab").classList.remove("bg-blue-500", "text-white");
    });

    document.getElementById("projects-tab").addEventListener("click", () => {
      document.getElementById("files-section").classList.add("hidden");
      document.getElementById("projects-section").classList.remove("hidden");
      document.getElementById("search-bar").style.display = "none";
      document.getElementById("projects-tab").classList.add("bg-blue-500", "text-white");
      document.getElementById("files-tab").classList.remove("bg-blue-500", "text-white");
    });

    function filterFiles(query) {
      document.querySelectorAll("#files-section .file-item").forEach(item => {
        item.style.display = item.textContent.toLowerCase().includes(query.toLowerCase()) ? "flex" : "none";
      });
    }
  </script>
</body>

</html>
